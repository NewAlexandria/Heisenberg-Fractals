%This script generates a Heisenberg Dragon when you input fixed points that
%differ in either the x or y coordinate alone. (ex: [0,0,0],[1,0,0])

%Deviations from this type of input lead to funky looking fractals that
%aren't as nice looking.

clearvars;
global h1 h2 h3 t1 t2 t3 theta1 theta2 theta3 g1 g2 g3 mixed1 sierpinsky;

display('WELCOME TO THE MIXED TOUCHING CONDITIONS MAKER.');
display('FOR BEST RESULTS, CHOOSE FIXED POINTS THAT ONLY DIFFER IN THE FIRST OR SECOND COORDINATE ALONE.');
h1 = input('ENTER YOUR H1');
h2 = input('ENTER YOUR H2');

touching = 1;

%Unused code for constructing a Heisenberg Sierpinski Gasket.
%{
variation = input('WOULD YOU LIKE THE SUPER DEE DUPER MIXED CONDITION?');
if variation == 0
   sierpinsky = input('WOULD YOU LIKE TO MAKE SOME TRIANGLES?');
   if sierpinsky ~= 0
      h3 = input('ENTER YOUR H3');
      t3 = sym('t3');
      theta3 = sym('theta3');
   end
else
    sierpinsky = 0;
end
%}

sierpinsky = 0;
iterations = input('HOW MANY ITERATIONS?');
display('MIX IT LIKE ITS HOT');

mixed1 = true;
t1 = sym('t1');
t2 = sym('t2');
theta1 = sym('theta1');
theta2 = sym('theta2');

if sierpinsky == 0
    x = [t1, t2, theta1, theta2];
else
    x = [t1,t2,t3,theta1,theta3,theta3];
end

if sierpinsky == 0
    if variation == 0
        
        r = @(x) [ h1(1) - h2(1) - x(1)*h1(1)*cos(x(3)) + x(1)*h2(1)*cos(x(3)) - x(2)*h1(1)*cos(x(4)) + x(2)*h2(1)*cos(x(4)) + x(1)*h1(2)*sin(x(3)) - x(1)*h2(2)*sin(x(3)) + x(2)*h1(2)*sin(x(4)) - x(2)*h2(2)*sin(x(4)) + 2*x(1)*x(2)*h1(1)*cos(x(3) + x(4)) - 2*x(1)*x(2)*h2(1)*cos(x(3) + x(4)) - 2*x(1)*x(2)*h1(2)*sin(x(3) + x(4)) + 2*x(1)*x(2)*h2(2)*sin(x(3) + x(4)), h1(2) - h2(2) - x(1)*h1(2)*cos(x(3)) + x(1)*h2(2)*cos(x(3)) - x(2)*h1(2)*cos(x(4)) + x(2)*h2(2)*cos(x(4)) - x(1)*h1(1)*sin(x(3)) + x(1)*h2(1)*sin(x(3)) - x(2)*h1(1)*sin(x(4)) + x(2)*h2(1)*sin(x(4)) + 2*x(1)*x(2)*h1(2)*cos(x(3) + x(4)) - 2*x(1)*x(2)*h2(2)*cos(x(3) + x(4)) + 2*x(1)*x(2)*h1(1)*sin(x(3) + x(4)) - 2*x(1)*x(2)*h2(1)*sin(x(3) + x(4)), x(1)^2*(x(2)^2*(h1(3) - (2*h2(3)*x(2)^2 + sin(x(4))*x(2)*h2(1)^2 + sin(x(4))*x(2)*h2(2)^2 - 2*h2(3))/(2*x(2)^2) + (h1(1)*(x(2)*h2(2) - h2(2)*cos(x(4)) + h2(1)*sin(x(4))))/(2*x(2)) + (h1(2)*(h2(1)*cos(x(4)) - x(2)*h2(1) + h2(2)*sin(x(4))))/(2*x(2))) - (2*h1(3)*x(1)^2 + sin(x(3))*x(1)*h1(1)^2 + sin(x(3))*x(1)*h1(2)^2 - 2*h1(3))/(2*x(1)^2) + ((h1(1)*cos(x(3)) - x(1)*h1(1) + h1(2)*sin(x(3)))*(h2(2) + x(2)*h1(2)*cos(x(4)) - x(2)*h2(2)*cos(x(4)) + x(2)*h1(1)*sin(x(4)) - x(2)*h2(1)*sin(x(4))))/(2*x(1)) + ((x(1)*h1(2) - h1(2)*cos(x(3)) + h1(1)*sin(x(3)))*(h2(1) + x(2)*h1(1)*cos(x(4)) - x(2)*h2(1)*cos(x(4)) - x(2)*h1(2)*sin(x(4)) + x(2)*h2(2)*sin(x(4))))/(2*x(1))) - x(2)^2*(x(1)^2*(h2(3) - (2*h1(3)*x(1)^2 + sin(x(3))*x(1)*h1(1)^2 + sin(x(3))*x(1)*h1(2)^2 - 2*h1(3))/(2*x(1)^2) + (h2(1)*(x(1)*h1(2) - h1(2)*cos(x(3)) + h1(1)*sin(x(3))))/(2*x(1)) + (h2(2)*(h1(1)*cos(x(3)) - x(1)*h1(1) + h1(2)*sin(x(3))))/(2*x(1))) - (2*h2(3)*x(2)^2 + sin(x(4))*x(2)*h2(1)^2 + sin(x(4))*x(2)*h2(2)^2 - 2*h2(3))/(2*x(2)^2) + ((h2(1)*cos(x(4)) - x(2)*h2(1) + h2(2)*sin(x(4)))*(h1(2) - x(1)*h1(2)*cos(x(3)) + x(1)*h2(2)*cos(x(3)) - x(1)*h1(1)*sin(x(3)) + x(1)*h2(1)*sin(x(3))))/(2*x(2)) + ((x(2)*h2(2) - h2(2)*cos(x(4)) + h2(1)*sin(x(4)))*(h1(1) - x(1)*h1(1)*cos(x(3)) + x(1)*h2(1)*cos(x(3)) + x(1)*h1(2)*sin(x(3)) - x(1)*h2(2)*sin(x(3))))/(2*x(2)))];
    else
   
        r = @(x) [h1(1) + x(1)*h2(1)*cos(x(3)) + x(2)*h2(1)*cos(x(4)) + x(1)*h1(2)*sin(x(3)) + x(2)*h1(2)*sin(x(4)) + x(1)^2*x(2)*h1(1)*cos(2*x(3) + x(4)) + x(1)^4*x(2)*h2(1)*cos(4*x(3) + x(4)) + x(1)^2*x(2)*h2(2)*sin(2*x(3) + x(4)) + x(1)^4*x(2)*h1(2)*sin(4*x(3) + x(4)) + x(1)*x(2)*h1(1)*cos(x(3) + x(4)) + x(1)*x(2)*h2(2)*sin(x(3) + x(4)) + x(1)^2*x(2)^3*h2(1)*cos(2*x(3) + 3*x(4)) + x(1)^2*x(2)^3*h1(2)*sin(2*x(3) + 3*x(4)) - (h2(1) + x(1)*h1(1)*cos(x(3)) + x(2)*h1(1)*cos(x(4)) + x(1)*h2(2)*sin(x(3)) + x(2)*h2(2)*sin(x(4)) + x(1)^2*x(2)*h2(1)*cos(2*x(3) + x(4)) + x(1)^4*x(2)*h1(1)*cos(4*x(3) + x(4)) + x(1)^2*x(2)*h1(2)*sin(2*x(3) + x(4)) + x(1)^4*x(2)*h2(2)*sin(4*x(3) + x(4)) + x(1)*x(2)*h2(1)*cos(x(3) + x(4)) + x(1)*x(2)*h1(2)*sin(x(3) + x(4)) + x(1)^2*x(2)^3*h1(1)*cos(2*x(3) + 3*x(4)) + x(1)^2*x(2)^3*h2(2)*sin(2*x(3) + 3*x(4))),h1(2) + x(1)*h2(2)*cos(x(3)) + x(2)*h2(2)*cos(x(4)) + x(1)*h2(1)*sin(x(3)) + x(2)*h2(1)*sin(x(4)) + x(1)^2*x(2)*h1(2)*cos(2*x(3) + x(4)) + x(1)^4*x(2)*h2(2)*cos(4*x(3) + x(4)) + x(1)^2*x(2)*h1(1)*sin(2*x(3) + x(4)) + x(1)^4*x(2)*h2(1)*sin(4*x(3) + x(4)) + x(1)*x(2)*h1(2)*cos(x(3) + x(4)) + x(1)*x(2)*h1(1)*sin(x(3) + x(4)) + x(1)^2*x(2)^3*h2(2)*cos(2*x(3) + 3*x(4)) + x(1)^2*x(2)^3*h2(1)*sin(2*x(3) + 3*x(4)) - (h2(2) + x(1)*h1(2)*cos(x(3)) + x(2)*h1(2)*cos(x(4)) + x(1)*h1(1)*sin(x(3)) + x(2)*h1(1)*sin(x(4)) + x(1)^2*x(2)*h2(2)*cos(2*x(3) + x(4)) + x(1)^4*x(2)*h1(2)*cos(4*x(3) + x(4)) + x(1)^2*x(2)*h2(1)*sin(2*x(3) + x(4)) + x(1)^4*x(2)*h1(1)*sin(4*x(3) + x(4)) + x(1)*x(2)*h2(2)*cos(x(3) + x(4)) + x(1)*x(2)*h2(1)*sin(x(3) + x(4)) + x(1)^2*x(2)^3*h1(2)*cos(2*x(3) + 3*x(4)) + x(1)^2*x(2)^3*h1(1)*sin(2*x(3) + 3*x(4))), 2*h1(3) + 2*x(1)^2*h2(3) + 2*x(2)^2*h2(3) + x(1)^2*h2(1)*h1(2) + x(2)^2*h2(1)*h1(2) + 2*x(1)^2*x(2)^2*h1(3) + 2*x(1)^4*x(2)^2*h1(3) + 2*x(1)^4*x(2)^6*h2(3) + 2*x(1)^8*x(2)^2*h2(3) + x(2)*h2(1)^2*sin(x(4)) + x(2)*h2(2)^2*sin(x(4)) + x(1)^2*x(2)^2*h1(1)^2*sin(2*x(3)) + x(1)^2*x(2)^2*h2(1)^2*sin(2*x(3)) + x(1)^4*x(2)^4*h1(1)^2*sin(2*x(4)) + x(1)^4*x(2)^4*h2(1)^2*sin(2*x(4)) + x(1)^2*x(2)^2*h1(2)^2*sin(2*x(3)) + x(1)^2*x(2)^2*h2(2)^2*sin(2*x(3)) + x(1)^4*x(2)^4*h1(2)^2*sin(2*x(4)) + x(1)^4*x(2)^4*h2(2)^2*sin(2*x(4)) + x(1)^2*x(2)^3*h2(1)^2*sin(2*x(3) + 3*x(4)) + x(1)^2*x(2)^3*h2(2)^2*sin(2*x(3) + 3*x(4)) + x(1)^5*x(2)*h1(1)^2*sin(3*x(3) + x(4)) + x(1)^5*x(2)*h2(1)^2*sin(3*x(3) + x(4)) + x(1)^5*x(2)*h1(2)^2*sin(3*x(3) + x(4)) + x(1)^5*x(2)*h2(2)^2*sin(3*x(3) + x(4)) + x(1)*h1(1)*h2(2)*cos(x(3)) + x(2)*h1(1)*h2(2)*cos(x(4)) + x(1)*h1(1)*h2(1)*sin(x(3)) + x(1)*h1(2)*h2(2)*sin(x(3)) + x(1)*x(2)*h1(1)^2*sin(x(3) + x(4)) + x(1)*x(2)*h1(2)^2*sin(x(3) + x(4)) + x(1)^2*x(2)^2*h1(1)*h2(2) + x(1)^4*x(2)^2*h1(1)*h2(2) + x(1)^4*x(2)^6*h2(1)*h1(2) + x(1)^8*x(2)^2*h2(1)*h1(2) + 2*x(1)^5*x(2)^2*h1(1)*h2(1)*sin(3*x(3)) + 2*x(1)^5*x(2)^2*h1(2)*h2(2)*sin(3*x(3)) + x(1)^2*x(2)^3*h1(1)*h2(2)*cos(2*x(3) + 3*x(4)) + 2*x(1)^2*x(2)^4*h1(1)*h2(1)*sin(2*x(3) + 2*x(4)) + 2*x(1)^2*x(2)^4*h1(2)*h2(2)*sin(2*x(3) + 2*x(4)) + 2*x(1)^2*x(2)*h1(1)*h2(1)*sin(x(4)) + 2*x(1)^2*x(2)*h1(2)*h2(2)*sin(x(4)) + x(1)^2*x(2)*h2(1)*h1(2)*cos(2*x(3) + x(4)) + x(1)^4*x(2)*h1(1)*h2(2)*cos(4*x(3) + x(4)) + x(1)^2*x(2)*h1(1)*h2(1)*sin(2*x(3) + x(4)) + x(1)^4*x(2)*h1(1)*h2(1)*sin(4*x(3) + x(4)) + x(1)^2*x(2)*h1(2)*h2(2)*sin(2*x(3) + x(4)) + x(1)^4*x(2)*h1(2)*h2(2)*sin(4*x(3) + x(4)) + x(1)*x(2)*h2(1)*h1(2)*cos(x(3) + x(4)) - (2*h2(3) + 2*x(1)^2*h1(3) + 2*x(2)^2*h1(3) + x(1)^2*h1(1)*h2(2) + x(2)^2*h1(1)*h2(2) + 2*x(1)^2*x(2)^2*h2(3) + 2*x(1)^4*x(2)^2*h2(3) + 2*x(1)^4*x(2)^6*h1(3) + 2*x(1)^8*x(2)^2*h1(3) + x(1)*h1(1)^2*sin(x(3)) + x(1)*h1(2)^2*sin(x(3)) + x(1)^5*x(2)^2*h1(1)^2*sin(3*x(3)) + x(1)^5*x(2)^2*h2(1)^2*sin(3*x(3)) + x(1)^5*x(2)^2*h1(2)^2*sin(3*x(3)) + x(1)^5*x(2)^2*h2(2)^2*sin(3*x(3)) + x(1)^2*x(2)^4*h1(1)^2*sin(2*x(3) + 2*x(4)) + x(1)^2*x(2)^4*h2(1)^2*sin(2*x(3) + 2*x(4)) + x(1)^2*x(2)^4*h1(2)^2*sin(2*x(3) + 2*x(4)) + x(1)^2*x(2)^4*h2(2)^2*sin(2*x(3) + 2*x(4)) + x(1)^2*x(2)*h1(1)^2*sin(x(4)) + x(1)^2*x(2)*h2(1)^2*sin(x(4)) + x(1)^2*x(2)*h1(2)^2*sin(x(4)) + x(1)^2*x(2)*h2(2)^2*sin(x(4)) + x(1)^2*x(2)*h2(1)^2*sin(2*x(3) + x(4)) + x(1)^4*x(2)*h1(1)^2*sin(4*x(3) + x(4)) + x(1)^2*x(2)*h2(2)^2*sin(2*x(3) + x(4)) + x(1)^4*x(2)*h1(2)^2*sin(4*x(3) + x(4)) + x(1)*h2(1)*h1(2)*cos(x(3)) + x(2)*h2(1)*h1(2)*cos(x(4)) + x(2)*h1(1)*h2(1)*sin(x(4)) + x(2)*h1(2)*h2(2)*sin(x(4)) + x(1)^2*x(2)^2*h2(1)*h1(2) + x(1)^4*x(2)^2*h2(1)*h1(2) + x(1)^4*x(2)^6*h1(1)*h2(2) + x(1)^8*x(2)^2*h1(1)*h2(2) + 2*x(1)^2*x(2)^2*h1(1)*h2(1)*sin(2*x(3)) + 2*x(1)^4*x(2)^4*h1(1)*h2(1)*sin(2*x(4)) + 2*x(1)^2*x(2)^2*h1(2)*h2(2)*sin(2*x(3)) + 2*x(1)^4*x(2)^4*h1(2)*h2(2)*sin(2*x(4)) + x(1)^2*x(2)^3*h2(1)*h1(2)*cos(2*x(3) + 3*x(4)) + x(1)^2*x(2)^3*h1(1)*h2(1)*sin(2*x(3) + 3*x(4)) + x(1)^2*x(2)^3*h1(2)*h2(2)*sin(2*x(3) + 3*x(4)) + x(1)^2*x(2)*h1(1)*h2(2)*cos(2*x(3) + x(4)) + x(1)^4*x(2)*h2(1)*h1(2)*cos(4*x(3) + x(4)) + 2*x(1)^5*x(2)*h1(1)*h2(1)*sin(3*x(3) + x(4)) + 2*x(1)^5*x(2)*h1(2)*h2(2)*sin(3*x(3) + x(4)) + x(1)*x(2)*h1(1)*h2(2)*cos(x(3) + x(4)) + x(1)*x(2)*h1(1)*h2(1)*sin(x(3) + x(4)) + x(1)*x(2)*h1(2)*h2(2)*sin(x(3) + x(4)))];
    end
    sol = fsolve(r,[sqrt(2)/2,sqrt(2)/2,pi/4,pi/4]);
    display(sol);

    t1 = sol(1);
    t2 = sol(2);
    theta1 = sol(3);
    theta2 = sol(4);

    %h1 = [3,6,3];
    %h2 = [2,1,-2];

    run('fractal');
else
    %Unused code for generating Heisenberg Sierpinski Gaskets
    
    %{
    z1 = sym('z1');
    z2 = sym('z2');
    z3 = sym('z3');
    %}
    
    
    x = [t1,t2,t3,theta1,theta2,theta3];
    %r = @(x) [ h1(1) - h2(1) - x(1)*h1(1)*cos(x(4)) + x(1)*h2(1)*cos(x(4)) - x(2)*h1(1)*cos(x(5)) + x(2)*h2(1)*cos(x(5)) + x(1)*h1(2)*sin(x(4)) - x(1)*h2(2)*sin(x(4)) + x(2)*h1(2)*sin(x(5)) - x(2)*h2(2)*sin(x(5)) + 2*x(1)*x(2)*h1(1)*cos(x(4) + x(5)) - 2*x(1)*x(2)*h2(1)*cos(x(4) + x(5)) - 2*x(1)*x(2)*h1(2)*sin(x(4) + x(5)) + 2*x(1)*x(2)*h2(2)*sin(x(4) + x(5)), h1(2) - h2(2) - x(1)*h1(2)*cos(x(4)) + x(1)*h2(2)*cos(x(4)) - x(2)*h1(2)*cos(x(5)) + x(2)*h2(2)*cos(x(5)) - x(1)*h1(1)*sin(x(4)) + x(1)*h2(1)*sin(x(4)) - x(2)*h1(1)*sin(x(5)) + x(2)*h2(1)*sin(x(5)) + 2*x(1)*x(2)*h1(2)*cos(x(4) + x(5)) - 2*x(1)*x(2)*h2(2)*cos(x(4) + x(5)) + 2*x(1)*x(2)*h1(1)*sin(x(4) + x(5)) - 2*x(1)*x(2)*h2(1)*sin(x(4) + x(5)), x(1)^2*(x(2)^2*(h1(3) - (2*x(2)^2*h2(3) - 2*h2(3) + x(2)*h2(1)^2*sin(x(5)) + x(2)*h2(2)^2*sin(x(5)))/(2*x(2)^2) + (h1(1)*(x(2)*h2(2) - h2(2)*cos(x(5)) + h2(1)*sin(x(5))))/(2*x(2)) + (h1(2)*(h2(1)*cos(x(5)) - x(2)*h2(1) + h2(2)*sin(x(5))))/(2*x(2))) - (2*x(1)^2*h1(3) - 2*h1(3) + x(1)*h1(1)^2*sin(x(4)) + x(1)*h1(2)^2*sin(x(4)))/(2*x(1)^2) + ((h1(1)*cos(x(4)) - x(1)*h1(1) + h1(2)*sin(x(4)))*(h2(2) + x(2)*h1(2)*cos(x(5)) - x(2)*h2(2)*cos(x(5)) + x(2)*h1(1)*sin(x(5)) - x(2)*h2(1)*sin(x(5))))/(2*x(1)) + ((x(1)*h1(2) - h1(2)*cos(x(4)) + h1(1)*sin(x(4)))*(h2(1) + x(2)*h1(1)*cos(x(5)) - x(2)*h2(1)*cos(x(5)) - x(2)*h1(2)*sin(x(5)) + x(2)*h2(2)*sin(x(5))))/(2*x(1))) - x(2)^2*(x(1)^2*(h2(3) - (2*x(1)^2*h1(3) - 2*h1(3) + x(1)*h1(1)^2*sin(x(4)) + x(1)*h1(2)^2*sin(x(4)))/(2*x(1)^2) + (h2(1)*(x(1)*h1(2) - h1(2)*cos(x(4)) + h1(1)*sin(x(4))))/(2*x(1)) + (h2(2)*(h1(1)*cos(x(4)) - x(1)*h1(1) + h1(2)*sin(x(4))))/(2*x(1))) - (2*x(2)^2*h2(3) - 2*h2(3) + x(2)*h2(1)^2*sin(x(5)) + x(2)*h2(2)^2*sin(x(5)))/(2*x(2)^2) + ((h2(1)*cos(x(5)) - x(2)*h2(1) + h2(2)*sin(x(5)))*(h1(2) - x(1)*h1(2)*cos(x(4)) + x(1)*h2(2)*cos(x(4)) - x(1)*h1(1)*sin(x(4)) + x(1)*h2(1)*sin(x(4))))/(2*x(2)) + ((x(2)*h2(2) - h2(2)*cos(x(5)) + h2(1)*sin(x(5)))*(h1(1) - x(1)*h1(1)*cos(x(4)) + x(1)*h2(1)*cos(x(4)) + x(1)*h1(2)*sin(x(4)) - x(1)*h2(2)*sin(x(4))))/(2*x(2))), h3(1) - h2(1) + x(2)*h2(1)*cos(x(5)) - x(2)*h3(1)*cos(x(5)) + x(3)*h2(1)*cos(x(6)) - x(3)*h3(1)*cos(x(6)) - x(2)*h2(2)*sin(x(5)) + x(2)*h3(2)*sin(x(5)) - x(3)*h2(2)*sin(x(6)) + x(3)*h3(2)*sin(x(6)) - 2*x(2)*x(3)*h2(1)*cos(x(5) + x(6)) + 2*x(2)*x(3)*h3(1)*cos(x(5) + x(6)) + 2*x(2)*x(3)*h2(2)*sin(x(5) + x(6)) - 2*x(2)*x(3)*h3(2)*sin(x(5) + x(6)), h3(2) - h2(2) + x(2)*h2(2)*cos(x(5)) - x(2)*h3(2)*cos(x(5)) + x(3)*h2(2)*cos(x(6)) - x(3)*h3(2)*cos(x(6)) + x(2)*h2(1)*sin(x(5)) - x(2)*h3(1)*sin(x(5)) + x(3)*h2(1)*sin(x(6)) - x(3)*h3(1)*sin(x(6)) - 2*x(2)*x(3)*h2(2)*cos(x(5) + x(6)) + 2*x(2)*x(3)*h3(2)*cos(x(5) + x(6)) 
    %- 2*x(2)*x(3)*h2(1)*sin(x(5) + x(6)) + 2*x(2)*x(3)*h3(1)*sin(x(5) + x(6)), x(3)^2*(x(2)^2*(h3(3) - (2*x(2)^2*h2(3) - 2*h2(3) + x(2)*h2(1)^2*sin(x(5)) + x(2)*h2(2)^2*sin(x(5)))/(2*x(2)^2) + (h3(1)*(x(2)*h2(2) - h2(2)*cos(x(5)) + h2(1)*sin(x(5))))/(2*x(2)) + (h3(2)*(h2(1)*cos(x(5)) - x(2)*h2(1) + h2(2)*sin(x(5))))/(2*x(2))) - (2*x(3)^2*h3(3) - 2*h3(3) + x(3)*h3(1)^2*sin(x(6)) + x(3)*h3(2)^2*sin(x(6)))/(2*x(3)^2) + ((h3(1)*cos(x(6)) - x(3)*h3(1) + h3(2)*sin(x(6)))*(h2(2) - x(2)*h2(2)*cos(x(5)) + x(2)*h3(2)*cos(x(5)) - x(2)*h2(1)*sin(x(5)) + x(2)*h3(1)*sin(x(5))))/(2*x(3)) + ((x(3)*h3(2) - h3(2)*cos(x(6)) + h3(1)*sin(x(6)))*(h2(1) - x(2)*h2(1)*cos(x(5)) + x(2)*h3(1)*cos(x(5)) + x(2)*h2(2)*sin(x(5)) - x(2)*h3(2)*sin(x(5))))/(2*x(3))) - x(2)^2*(x(3)^2*(h2(3) - (2*x(3)^2*h3(3) - 2*h3(3) + x(3)*h3(1)^2*sin(x(6)) + x(3)*h3(2)^2*sin(x(6)))/(2*x(3)^2) + (h2(1)*(x(3)*h3(2) - h3(2)*cos(x(6)) + h3(1)*sin(x(6))))/(2*x(3)) + (h2(2)*(h3(1)*cos(x(6)) - x(3)*h3(1) + h3(2)*sin(x(6))))/(2*x(3))) - (2*x(2)^2*h2(3) - 2*h2(3) + x(2)*h2(1)^2*sin(x(5)) + x(2)*h2(2)^2*sin(x(5)))/(2*x(2)^2) + ((h2(1)*cos(x(5)) - x(2)*h2(1) + h2(2)*sin(x(5)))*(h3(2) + x(3)*h2(2)*cos(x(6)) - x(3)*h3(2)*cos(x(6)) + x(3)*h2(1)*sin(x(6)) - x(3)*h3(1)*sin(x(6))))/(2*x(2)) + ((x(2)*h2(2) - h2(2)*cos(x(5)) + h2(1)*sin(x(5)))*(h3(1) + x(3)*h2(1)*cos(x(6)) - x(3)*h3(1)*cos(x(6)) - x(3)*h2(2)*sin(x(6)) + x(3)*h3(2)*sin(x(6))))/(2*x(2))), h1(1) - h3(1) - x(1)*h1(1)*cos(x(4)) + x(1)*h3(1)*cos(x(4)) - x(3)*h1(1)*cos(x(6)) + x(3)*h3(1)*cos(x(6)) + x(1)*h1(2)*sin(x(4)) - x(1)*h3(2)*sin(x(4)) + x(3)*h1(2)*sin(x(6)) - x(3)*h3(2)*sin(x(6)) + 2*x(1)*x(3)*h1(1)*cos(x(4) + x(6)) - 2*x(1)*x(3)*h3(1)*cos(x(4) + x(6)) - 2*x(1)*x(3)*h1(2)*sin(x(4) + x(6)) + 2*x(1)*x(3)*h3(2)*sin(x(4) + x(6)), h1(2) - h3(2) - x(1)*h1(2)*cos(x(4)) + x(1)*h3(2)*cos(x(4)) - x(3)*h1(2)*cos(x(6)) + x(3)*h3(2)*cos(x(6)) - x(1)*h1(1)*sin(x(4)) + x(1)*h3(1)*sin(x(4)) - x(3)*h1(1)*sin(x(6)) + x(3)*h3(1)*sin(x(6)) + 2*x(1)*x(3)*h1(2)*cos(x(4) + x(6)) - 2*x(1)*x(3)*h3(2)*cos(x(4) + x(6)) + 2*x(1)*x(3)*h1(1)*sin(x(4) + x(6)) - 2*x(1)*x(3)*h3(1)*sin(x(4) + x(6)), x(1)^2*(x(3)^2*(h1(3) - (2*x(3)^2*h3(3) - 2*h3(3) + x(3)*h3(1)^2*sin(x(6)) + x(3)*h3(2)^2*sin(x(6)))/(2*x(3)^2) + (h1(1)*(x(3)*h3(2) - h3(2)*cos(x(6)) + h3(1)*sin(x(6))))/(2*x(3)) + (h1(2)*(h3(1)*cos(x(6)) - x(3)*h3(1) + h3(2)*sin(x(6))))/(2*x(3))) - (2*x(1)^2*h1(3) - 2*h1(3) + x(1)*h1(1)^2*sin(x(4)) + x(1)*h1(2)^2*sin(x(4)))/(2*x(1)^2) + ((h1(1)*cos(x(4)) - x(1)*h1(1) + h1(2)*sin(x(4)))*(h3(2) + x(3)*h1(2)*cos(x(6)) - x(3)*h3(2)*cos(x(6)) + x(3)*h1(1)*sin(x(6)) - x(3)*h3(1)*sin(x(6))))/(2*x(1)) + ((x(1)*h1(2) - h1(2)*cos(x(4)) + h1(1)*sin(x(4)))*(h3(1) + x(3)*h1(1)*cos(x(6)) - x(3)*h3(1)*cos(x(6)) - x(3)*h1(2)*sin(x(6)) + x(3)*h3(2)*sin(x(6))))/(2*x(1))) - x(3)^2*(x(1)^2*(h3(3) - (2*x(1)^2*h1(3) - 2*h1(3) + x(1)*h1(1)^2*sin(x(4)) + x(1)*h1(2)^2*sin(x(4)))/(2*x(1)^2) + (h3(1)*(x(1)*h1(2) - h1(2)*cos(x(4)) + h1(1)*sin(x(4))))/(2*x(1)) + (h3(2)*(h1(1)*cos(x(4)) - x(1)*h1(1) + h1(2)*sin(x(4))))/(2*x(1))) - (2*x(3)^2*h3(3) - 2*h3(3) + x(3)*h3(1)^2*sin(x(6)) + x(3)*h3(2)^2*sin(x(6)))/(2*x(3)^2) + ((h3(1)*cos(x(6)) - x(3)*h3(1) + h3(2)*sin(x(6)))*(h1(2) - x(1)*h1(2)*cos(x(4)) + x(1)*h3(2)*cos(x(4)) - x(1)*h1(1)*sin(x(4)) + x(1)*h3(1)*sin(x(4))))/(2*x(3)) + ((x(3)*h3(2) - h3(2)*cos(x(6)) + h3(1)*sin(x(6)))*(h1(1) - x(1)*h1(1)*cos(x(4)) + x(1)*h3(1)*cos(x(4)) + x(1)*h1(2)*sin(x(4)) - x(1)*h3(2)*sin(x(4))))/(2*x(3)))];
    
    %F1h2 = F2h1, F2h3 = F3h2, F3h1 = F1h3
    %Solving for h3
    %r = @(x) [ h1(1) - h2(1) - h1(1)*x(1)*cos(x(4)) + h2(1)*x(1)*cos(x(4)) - h1(1)*x(2)*cos(x(5)) + h2(1)*x(2)*cos(x(5)) + h1(2)*x(1)*sin(x(4)) - h2(2)*x(1)*sin(x(4)) + h1(2)*x(2)*sin(x(5)) - h2(2)*x(2)*sin(x(5)), h1(2) - h2(2) - h1(2)*x(1)*cos(x(4)) + h2(2)*x(1)*cos(x(4)) - h1(2)*x(2)*cos(x(5)) + h2(2)*x(2)*cos(x(5)) - h1(1)*x(1)*sin(x(4)) + h2(1)*x(1)*sin(x(4)) - h1(1)*x(2)*sin(x(5)) + h2(1)*x(2)*sin(x(5)), x(1)^2*(h2(3) - (2*h1(3)*x(1)^2 - 2*h1(3) + h1(1)^2*x(1)*sin(x(4)) + h1(2)^2*x(1)*sin(x(4)))/(2*x(1)^2) + (h2(1)*(h1(2)*x(1) - h1(2)*cos(x(4)) + h1(1)*sin(x(4))))/(2*x(1)) + (h2(2)*(h1(1)*cos(x(4)) - h1(1)*x(1) + h1(2)*sin(x(4))))/(2*x(1))) - x(2)^2*(h1(3) - (2*h2(3)*x(2)^2 - 2*h2(3) + h2(1)^2*x(2)*sin(x(5)) + h2(2)^2*x(2)*sin(x(5)))/(2*x(2)^2) + (h1(1)*(h2(2)*x(2) - h2(2)*cos(x(5)) + h2(1)*sin(x(5))))/(2*x(2)) + (h1(2)*(h2(1)*cos(x(5)) - h2(1)*x(2) + h2(2)*sin(x(5))))/(2*x(2))), h2(1) - x(7) - h2(1)*x(2)*cos(x(5)) - h2(1)*x(3)*cos(x(6)) + h2(2)*x(2)*sin(x(5)) + h2(2)*x(3)*sin(x(6)) + x(2)*x(7)*cos(x(5)) + x(3)*x(7)*cos(x(6)) - x(2)*x(8)*sin(x(5)) - x(3)*x(8)*sin(x(6)), h2(2) - x(8) - h2(2)*x(2)*cos(x(5)) - h2(2)*x(3)*cos(x(6)) - h2(1)*x(2)*sin(x(5)) - h2(1)*x(3)*sin(x(6)) + x(2)*x(8)*cos(x(5)) + x(3)*x(8)*cos(x(6)) + x(2)*x(7)*sin(x(5)) + x(3)*x(7)*sin(x(6)), x(2)^2*(x(9) - (2*h2(3)*x(2)^2 - 2*h2(3) + h2(1)^2*x(2)*sin(x(5)) + h2(2)^2*x(2)*sin(x(5)))/(2*x(2)^2) + (x(7)*(h2(2)*x(2) - h2(2)*cos(x(5)) + h2(1)*sin(x(5))))/(2*x(2)) + (x(8)*(h2(1)*cos(x(5)) - h2(1)*x(2) + h2(2)*sin(x(5))))/(2*x(2))) - x(3)^2*(h2(3) - (2*x(3)^2*x(9) - 2*x(9) + x(3)*x(7)^2*sin(x(6)) + x(3)*x(8)^2*sin(x(6)))/(2*x(3)^2) + (h2(1)*(x(3)*x(8) - x(8)*cos(x(6)) + x(7)*sin(x(6))))/(2*x(3)) + (h2(2)*(x(7)*cos(x(6)) - x(3)*x(7) + x(8)*sin(x(6))))/(2*x(3))), x(7) - h1(1) + h1(1)*x(1)*cos(x(4)) + h1(1)*x(3)*cos(x(6)) - h1(2)*x(1)*sin(x(4)) - h1(2)*x(3)*sin(x(6)) - x(1)*x(7)*cos(x(4)) - x(3)*x(7)*cos(x(6)) + x(1)*x(8)*sin(x(4)) + x(3)*x(8)*sin(x(6)), x(8) - h1(2) + h1(2)*x(1)*cos(x(4)) + h1(2)*x(3)*cos(x(6)) + h1(1)*x(1)*sin(x(4)) + h1(1)*x(3)*sin(x(6)) - x(1)*x(8)*cos(x(4)) - x(3)*x(8)*cos(x(6)) - x(1)*x(7)*sin(x(4)) - x(3)*x(7)*sin(x(6)), x(3)^2*(h1(3) - (2*x(3)^2*x(9) - 2*x(9) + x(3)*x(7)^2*sin(x(6)) + x(3)*x(8)^2*sin(x(6)))/(2*x(3)^2) + (h1(1)*(x(3)*x(8) - x(8)*cos(x(6)) + x(7)*sin(x(6))))/(2*x(3)) + (h1(2)*(x(7)*cos(x(6)) - x(3)*x(7) + x(8)*sin(x(6))))/(2*x(3))) - x(1)^2*(x(9) - (2*h1(3)*x(1)^2 - 2*h1(3) + h1(1)^2*x(1)*sin(x(4)) + h1(2)^2*x(1)*sin(x(4)))/(2*x(1)^2) + (x(7)*(h1(2)*x(1) - h1(2)*cos(x(4)) + h1(1)*sin(x(4))))/(2*x(1)) + (x(8)*(h1(1)*cos(x(4)) - h1(1)*x(1) + h1(2)*sin(x(4))))/(2*x(1)))];

    
    %Solving for all three z-values
    %r = @(x) [ h1(1) - h2(1) - h1(1)*x(1)*cos(x(4)) + h2(1)*x(1)*cos(x(4)) - h1(1)*x(2)*cos(x(5)) + h2(1)*x(2)*cos(x(5)) + h1(2)*x(1)*sin(x(4)) - h2(2)*x(1)*sin(x(4)) + h1(2)*x(2)*sin(x(5)) - h2(2)*x(2)*sin(x(5)), h1(2) - h2(2) - h1(2)*x(1)*cos(x(4)) + h2(2)*x(1)*cos(x(4)) - h1(2)*x(2)*cos(x(5)) + h2(2)*x(2)*cos(x(5)) - h1(1)*x(1)*sin(x(4)) + h2(1)*x(1)*sin(x(4)) - h1(1)*x(2)*sin(x(5)) + h2(1)*x(2)*sin(x(5)), x(1)^2*(x(8) - (2*x(7)*x(1)^2 - 2*x(7) + h1(1)^2*x(1)*sin(x(4)) + h1(2)^2*x(1)*sin(x(4)))/(2*x(1)^2) + (h2(1)*(h1(2)*x(1) - h1(2)*cos(x(4)) + h1(1)*sin(x(4))))/(2*x(1)) + (h2(2)*(h1(1)*cos(x(4)) - h1(1)*x(1) + h1(2)*sin(x(4))))/(2*x(1))) - x(2)^2*(x(7) - (2*x(8)*x(2)^2 - 2*x(8) + h2(1)^2*x(2)*sin(x(5)) + h2(2)^2*x(2)*sin(x(5)))/(2*x(2)^2) + (h1(1)*(h2(2)*x(2) - h2(2)*cos(x(5)) + h2(1)*sin(x(5))))/(2*x(2)) + (h1(2)*(h2(1)*cos(x(5)) - h2(1)*x(2) + h2(2)*sin(x(5))))/(2*x(2))), h2(1) - h3(1) - h2(1)*x(2)*cos(x(5)) - h2(1)*x(3)*cos(x(6)) + h2(2)*x(2)*sin(x(5)) + h2(2)*x(3)*sin(x(6)) + x(2)*h3(1)*cos(x(5)) + x(3)*h3(1)*cos(x(6)) - x(2)*h3(2)*sin(x(5)) - x(3)*h3(2)*sin(x(6)), h2(2) - h3(2) - h2(2)*x(2)*cos(x(5)) - h2(2)*x(3)*cos(x(6)) - h2(1)*x(2)*sin(x(5)) - h2(1)*x(3)*sin(x(6)) + x(2)*h3(2)*cos(x(5)) + x(3)*h3(2)*cos(x(6)) + x(2)*h3(1)*sin(x(5)) + x(3)*h3(1)*sin(x(6)), x(2)^2*(x(9) - (2*x(8)*x(2)^2 - 2*x(8) + h2(1)^2*x(2)*sin(x(5)) + h2(2)^2*x(2)*sin(x(5)))/(2*x(2)^2) + (h3(1)*(h2(2)*x(2) - h2(2)*cos(x(5)) + h2(1)*sin(x(5))))/(2*x(2)) + (h3(2)*(h2(1)*cos(x(5)) - h2(1)*x(2) + h2(2)*sin(x(5))))/(2*x(2))) - x(3)^2*(x(8) - (2*x(3)^2*x(9) - 2*x(9) + x(3)*h3(1)^2*sin(x(6)) + x(3)*h3(2)^2*sin(x(6)))/(2*x(3)^2) + (h2(1)*(x(3)*h3(2) - h3(2)*cos(x(6)) + h3(1)*sin(x(6))))/(2*x(3)) + (h2(2)*(h3(1)*cos(x(6)) - x(3)*h3(1) + h3(2)*sin(x(6))))/(2*x(3))), h3(1) - h1(1) + h1(1)*x(1)*cos(x(4)) + h1(1)*x(3)*cos(x(6)) - h1(2)*x(1)*sin(x(4)) - h1(2)*x(3)*sin(x(6)) - x(1)*h3(1)*cos(x(4)) - x(3)*h3(1)*cos(x(6)) + x(1)*h3(2)*sin(x(4)) + x(3)*h3(2)*sin(x(6)), h3(2) - h1(2) + h1(2)*x(1)*cos(x(4)) + h1(2)*x(3)*cos(x(6)) + h1(1)*x(1)*sin(x(4)) + h1(1)*x(3)*sin(x(6)) - x(1)*h3(2)*cos(x(4)) - x(3)*h3(2)*cos(x(6)) - x(1)*h3(1)*sin(x(4)) - x(3)*h3(1)*sin(x(6)), x(3)^2*(x(7) - (2*x(3)^2*x(9) - 2*x(9) + x(3)*h3(1)^2*sin(x(6)) + x(3)*h3(2)^2*sin(x(6)))/(2*x(3)^2) + (h1(1)*(x(3)*h3(2) - h3(2)*cos(x(6)) + h3(1)*sin(x(6))))/(2*x(3)) + (h1(2)*(h3(1)*cos(x(6)) - x(3)*h3(1) + h3(2)*sin(x(6))))/(2*x(3))) - x(1)^2*(x(9) - (2*x(7)*x(1)^2 - 2*x(7) + h1(1)^2*x(1)*sin(x(4)) + h1(2)^2*x(1)*sin(x(4)))/(2*x(1)^2) + (h3(1)*(h1(2)*x(1) - h1(2)*cos(x(4)) + h1(1)*sin(x(4))))/(2*x(1)) + (h3(2)*(h1(1)*cos(x(4)) - h1(1)*x(1) + h1(2)*sin(x(4))))/(2*x(1)))];
    
    %Ignoring the third touching condition
    r = @(x) [ h1(1) - h2(1) - x(1)*h1(1)*cos(x(4)) + x(1)*h2(1)*cos(x(4)) - x(2)*h1(1)*cos(x(5)) + x(2)*h2(1)*cos(x(5)) + x(1)*h1(2)*sin(x(4)) - x(1)*h2(2)*sin(x(4)) + x(2)*h1(2)*sin(x(5)) - x(2)*h2(2)*sin(x(5)), h1(2) - h2(2) - x(1)*h1(2)*cos(x(4)) + x(1)*h2(2)*cos(x(4)) - x(2)*h1(2)*cos(x(5)) + x(2)*h2(2)*cos(x(5)) - x(1)*h1(1)*sin(x(4)) + x(1)*h2(1)*sin(x(4)) - x(2)*h1(1)*sin(x(5)) + x(2)*h2(1)*sin(x(5)), x(1)^2*(h2(3) - (2*x(1)^2*h1(3) - 2*h1(3) + x(1)*h1(1)^2*sin(x(4)) + x(1)*h1(2)^2*sin(x(4)))/(2*x(1)^2) + (h2(1)*(x(1)*h1(2) - h1(2)*cos(x(4)) + h1(1)*sin(x(4))))/(2*x(1)) + (h2(2)*(h1(1)*cos(x(4)) - x(1)*h1(1) + h1(2)*sin(x(4))))/(2*x(1))) - x(2)^2*(h1(3) - (2*x(2)^2*h2(3) - 2*h2(3) + x(2)*h2(1)^2*sin(x(5)) + x(2)*h2(2)^2*sin(x(5)))/(2*x(2)^2) + (h1(1)*(x(2)*h2(2) - h2(2)*cos(x(5)) + h2(1)*sin(x(5))))/(2*x(2)) + (h1(2)*(h2(1)*cos(x(5)) - x(2)*h2(1) + h2(2)*sin(x(5))))/(2*x(2))), h2(1) - h3(1) - x(2)*h2(1)*cos(x(5)) + x(2)*h3(1)*cos(x(5)) - x(3)*h2(1)*cos(x(6)) + x(3)*h3(1)*cos(x(6)) + x(2)*h2(2)*sin(x(5)) - x(2)*h3(2)*sin(x(5)) + x(3)*h2(2)*sin(x(6)) - x(3)*h3(2)*sin(x(6)), h2(2) - h3(2) - x(2)*h2(2)*cos(x(5)) + x(2)*h3(2)*cos(x(5)) - x(3)*h2(2)*cos(x(6)) + x(3)*h3(2)*cos(x(6)) - x(2)*h2(1)*sin(x(5)) + x(2)*h3(1)*sin(x(5)) - x(3)*h2(1)*sin(x(6)) + x(3)*h3(1)*sin(x(6)), x(2)^2*(h3(3) - (2*x(2)^2*h2(3) - 2*h2(3) + x(2)*h2(1)^2*sin(x(5)) + x(2)*h2(2)^2*sin(x(5)))/(2*x(2)^2) + (h3(1)*(x(2)*h2(2) - h2(2)*cos(x(5)) + h2(1)*sin(x(5))))/(2*x(2)) + (h3(2)*(h2(1)*cos(x(5)) - x(2)*h2(1) + h2(2)*sin(x(5))))/(2*x(2))) - x(3)^2*(h2(3) - (2*x(3)^2*h3(3) - 2*h3(3) + x(3)*h3(1)^2*sin(x(6)) + x(3)*h3(2)^2*sin(x(6)))/(2*x(3)^2) + (h2(1)*(x(3)*h3(2) - h3(2)*cos(x(6)) + h3(1)*sin(x(6))))/(2*x(3)) + (h2(2)*(h3(1)*cos(x(6)) - x(3)*h3(1) + h3(2)*sin(x(6))))/(2*x(3)))];
   
    sol = fsolve(r,[0.5,0.5,0.5,pi/3,pi/3,pi/3],optimset('MaxFunEvals',100000,'MaxIter',100000));
    display(sol);
    
   inquiry = input('ARE YOU SATISFIED?');
   if inquiry ~= 0
       t1 = sol(1);
       t2 = sol(2);
       t3 = sol(3);
       theta1 = sol(4);
       theta2 = sol(5);
       theta3 = sol(6);
       run('fractal');
   end
    
end